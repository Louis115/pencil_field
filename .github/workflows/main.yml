name: pencil_field_testing
run-name: ${{ github.actor }} is analyzing & testing the code
on: [push]
jobs:
  drive:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: subosito/flutter-action@v2
    - run: flutter pub get
    - run: flutter --version
    - run: dart analyze
    - run: mkdir test/resulting_output
    - run: flutter test --machine > test_results.json

    - name: Check Test Results
        run: |
          if [ "$(grep -c 'All tests passed!' $GITHUB_WORKSPACE/test-results.json)" -ne 1 ]; then
            echo "One or more tests failed. Please fix the failing tests and try again."
            exit 1
          fi
